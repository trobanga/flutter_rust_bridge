"use strict";(self.webpackChunkflutter_rust_bridge=self.webpackChunkflutter_rust_bridge||[]).push([[8241],{3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>m});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var c=n.createContext({}),l=function(e){var t=n.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},u=function(e){var t=l(e.components);return n.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,i=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=l(r),m=a,f=p["".concat(c,".").concat(m)]||p[m]||d[m]||i;return r?n.createElement(f,o(o({ref:t},u),{},{components:r})):n.createElement(f,o({ref:t},u))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=r.length,o=new Array(i);o[0]=p;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var l=2;l<i;l++)o[l]=r[l];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}p.displayName="MDXCreateElement"},2391:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var n=r(7462),a=(r(7294),r(3905));const i={},o="Expanding macros",s={unversionedId:"guides/miscellaneous/expanding-macros",id:"guides/miscellaneous/expanding-macros",title:"Expanding macros",description:"This library automatically handles macros inside your code. For example, support you calls a macro that will generate a struct, then even if that struct is not in the code directly, this library can understand it.",source:"@site/docs/guides/miscellaneous/expanding-macros.md",sourceDirName:"guides/miscellaneous",slug:"/guides/miscellaneous/expanding-macros",permalink:"/flutter_rust_bridge/guides/miscellaneous/expanding-macros",draft:!1,editUrl:"https://github.com/fzyzcjy/flutter_rust_bridge/tree/master/website/docs/guides/miscellaneous/expanding-macros.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Run in build.rs",permalink:"/flutter_rust_bridge/guides/miscellaneous/build-rs"},next:{title:"Ignoring Functions",permalink:"/flutter_rust_bridge/guides/miscellaneous/ignoring-functions"}},c={},l=[],u={toc:l};function d(e){let{components:t,...r}=e;return(0,a.kt)("wrapper",(0,n.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"expanding-macros"},"Expanding macros"),(0,a.kt)("p",null,"This library automatically handles macros inside your code. For example, support you calls a macro that will generate a struct, then even if that struct is not in the code directly, this library can understand it."),(0,a.kt)("p",null,"The implementation is as follows: To produce code for types or functions that are generated through macros, it is necessary to first expand the code before it is parsed. This is done by invoking ",(0,a.kt)("a",{parentName:"p",href:"https://crates.io/crates/cargo-expand"},"cargo-expand"),", a tool that expands all macros, resulting in code that can then be parsed."),(0,a.kt)("p",null,"When you integrate the invoke-code-generator-within-",(0,a.kt)("inlineCode",{parentName:"p"},"build.rs")," functionality, this expansion process cannot be utilized.\nThe issue here is that ",(0,a.kt)("inlineCode",{parentName:"p"},"cargo-expand")," triggers a project build, and invoking it within ",(0,a.kt)("inlineCode",{parentName:"p"},"build.rs")," would lead to a deadlock, as ",(0,a.kt)("inlineCode",{parentName:"p"},"cargo-expand")," would wait for the calling cargo build to complete.\nIn such cases, code is read from files without macro expansion.\nIf your API definition does not rely on macros for code generation, this works fine.\nOtherwise, you have to call the ",(0,a.kt)("inlineCode",{parentName:"p"},"flutter_rust_bridge_codegen")," binary seperately."))}d.isMDXComponent=!0}}]);